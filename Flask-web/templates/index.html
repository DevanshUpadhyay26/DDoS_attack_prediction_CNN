<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDoS Detection</title>
</head>
<body>
    <h1>DDoS Detection</h1>
    <nav>
        <a href="{{ url_for('blacklist_table') }}">Blacklist Table</a>
    </nav>
    <hr><br>
    <form method="post"> 
        <!-- Add input fields for the features your model expects -->
        <label for="proto_number">Protocol Number:</label>
        <input type="number" name="proto_number" required><br>

        <label for="saddr">Sender Address:</label>
        <input type="text" name="saddr" required><br>

        <label for="daddr">Destination Address:</label>
        <input type="text" name="daddr" required><br>

        <label for="pkts">Packets:</label>
        <input type="number" name="pkts" required><br>

        <label for="bytes">Bytes:</label>
        <input type="number" name="bytes" required><br>

        <label for="ltime">Ltime:</label>
        <input type="number" name="ltime" required><br>

        <label for="seq">Seq:</label>
        <input type="number" name="seq" required><br>

        <label for="dur">Duration:</label>
        <input type="number" name="dur" step="0.01" required><br>

        <label for="mean">Mean:</label>
        <input type="number" name="mean" step="0.01" required><br>

        <label for="stddev">Std dev:</label>
        <input type="number" name="stddev" step="0.01" required><br>

        <label for="sum">Sum:</label>
        <input type="number" name="sum" step="0.01" required><br>

        <label for="min">Min:</label>
        <input type="number" name="min" step="0.01" required><br>

        <label for="max">Max:</label>
        <input type="number" name="max" step="0.01" required><br>

        <label for="spkts">Sender Pkts:</label>
        <input type="number" name="spkts" required><br>

        <label for="dpkts">Destination Pkts:</label>
        <input type="number" name="dpkts" required><br>

        <label for="sbytes">Sender Bytes:</label>
        <input type="number" name="sbytes" required><br>

        <label for="dbytes">Destination Bytes:</label>
        <input type="number" name="dbytes" required><br>

        <label for="rate">Rate:</label>
        <input type="number" name="rate" step="0.01" required><br>

        <label for="srate">Sender Rate:</label>
        <input type="number" name="srate" step="0.01" required><br>

        <label for="drate">Destination Rate:</label>
        <input type="number" name="drate" step="0.01" required><br>

        <label for="TnBPSrcIP">TnBPSrcIP:</label>
        <input type="number" name="TnBPSrcIP" required><br>

        <label for="TnBPDstIP">TnBPDstIP:</label>
        <input type="number" name="TnBPDstIP" required><br>

        <label for="TnP_PSrcIP">TnP_PSrcIP:</label>
        <input type="number" name="TnP_PSrcIP" required><br>

        <label for="TnP_PDstIP">TnP_PDstIP:</label>
        <input type="number" name="TnP_PDstIP" required><br>

        <label for="TnP_PerProto">TnP_PerProto:</label>
        <input type="number" name="TnP_PerProto" required><br>

        <label for="TnP_Per_Dport">TnP_Per_Dport:</label>
        <input type="number" name="TnP_Per_Dport" required><br>

        <label for="AR_P_Proto_P_SrcIP">AR_P_Proto_P_SrcIP:</label>
        <input type="number" name="AR_P_Proto_P_SrcIP" required><br>

        <label for="AR_P_Proto_P_DstIP">AR_P_Proto_P_DstIP:</label>
        <input type="number" name="AR_P_Proto_P_DstIP" required><br>

        <label for="N_IN_Conn_P_DstIP">N_IN_Conn_P_DstIP:</label>
        <input type="number" name="N_IN_Conn_P_DstIP" required><br>
        
        <label for="N_IN_Conn_P_SrcIP">N_IN_Conn_P_SrcIP:</label>
        <input type="number" name="N_IN_Conn_P_SrcIP" required><br>

        <label for="AR_P_Proto_P_Sport">AR_P_Proto_P_Sport:</label>
        <input type="number" name="AR_P_Proto_P_Sport" required><br>

        <label for="AR_P_Proto_P_Dport">AR_P_Proto_P_Dport:</label>
        <input type="number" name="AR_P_Proto_P_Dport" required><br>

        <label for="Pkts_P_State_P_Protocol_P_DestIP">Pkts_P_State_P_Protocol_P_DestIP:</label>
        <input type="number" name="Pkts_P_State_P_Protocol_P_DestIP" required><br>

        <label for="Pkts_P_State_P_Protocol_P_SrcIP">Pkts_P_State_P_Protocol_P_SrcIP:</label>
        <input type="number" name="Pkts_P_State_P_Protocol_P_SrcIP" required><br>

        <label for="state">State:</label>
        <select name="state" required>
            <option value="INT">INT</option>
            <option value="CON">CON</option>
            <option value="URP">URP</option>
            <option value="FIN">FIN</option>
            <option value="NRS">NRS</option>
            <option value="RST">RST</option>
            <option value="ECO">ECO</option>
            <option value="TST">TST</option>
            <option value="MAS">MAS</option>
            <option value="REQ">REQ</option>
        </select><br>



        <button type="submit">Predict</button>
    </form>

    {% if prediction is not none %}
    <h2>Prediction: {{ prediction }}</h2>
    {% endif %}

    
</body>
</html>
